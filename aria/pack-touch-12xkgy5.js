/*
 * Copyright 2009-2014 Amadeus s.a.s.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
//***MULTI-PART
//*******************
//LOGICAL-PATH:aria/touch/Event.js
//*******************
var e=require("../Aria");module.exports=e.classDefinition({$singleton:!0,$classpath:"aria.touch.Event",$constructor:function(){this.touchEventMap={touchstart:"touchstart",touchend:"touchend",touchmove:"touchmove"},this.touch=!0,this.__touchDetection()},$prototype:{__touchDetection:function(){return e.$frameworkWindow?(this.touch="ontouchstart"in e.$frameworkWindow||e.$frameworkWindow.DocumentTouch&&e.$frameworkWindow.document instanceof e.$frameworkWindow.DocumentTouch,this.touch||(this.touchEventMap={touchstart:"mousedown",touchend:"mouseup",touchmove:"mousemove"}),void(e.$window.navigator.msPointerEnabled&&(this.touchEventMap={touchstart:"MSPointerDown",touchend:"MSPointerUp",touchmove:"MSPointerMove"}))):void(this.touch=!1)},getPositions:function(e){var t=[];if(e.touches&&e.touches[0]||e.changedTouches&&e.changedTouches[0]){for(var i=0;i<e.touches.length;i++)t.push({x:e.touches[i].pageX?e.touches[i].pageX:e.touches[i].clientX,y:e.touches[i].pageY?e.touches[i].pageY:e.touches[i].clientY});if(e.type==this.touchEventMap.touchend)for(var i=0;i<e.changedTouches.length;i++)t.push({x:e.changedTouches[i].pageX?e.changedTouches[i].pageX:e.changedTouches[i].clientX,y:e.changedTouches[i].pageY?e.changedTouches[i].pageY:e.changedTouches[i].clientY})}else t.push({x:e.pageX?e.pageX:e.clientX,y:e.pageY?e.pageY:e.clientY});return t},getFingerIndex:function(t){var i=0;if(e.$window.navigator.msPointerEnabled)i=t.isPrimary?0:1;else if(t.touches||t.changedTouches)if(t.changedTouches.length>1)i=100+t.changedTouches.length;else if(t.type==this.touchEventMap.touchend)i=t.touches.length+t.changedTouches.length-1;else for(var r=t.changedTouches[0].pageX?t.changedTouches[0].pageX:t.changedTouches[0].clientX,s=t.changedTouches[0].pageY?t.changedTouches[0].pageY:t.changedTouches[0].clientY,a=0;a<t.touches.length;a++)if(r==(t.touches[a].pageX?t.touches[a].pageX:t.touches[a].clientX)&&s==(t.touches[a].pageY?t.touches[a].pageY:t.touches[a].clientY)){i=a;break}return i}}});
//*******************
//LOGICAL-PATH:aria/touch/Gesture.js
//*******************
var e=require("../Aria"),t=require("../utils/Event"),i=require("../utils/Delegate"),r=require("../utils/AriaWindow"),s=require("./Event");module.exports=e.classDefinition({$classpath:"aria.touch.Gesture",$statics:{NB_TOUCHES:1},$constructor:function(){this.body={},this.touchEventMap=s.touchEventMap;var e=r;e.$on({attachWindow:this._connectTouchEvents,detachWindow:this._disconnectTouchEvents,scope:this}),this.eventsAlreadyAttached=!1,e.isWindowUsed&&this._connectTouchEvents(),this.timerId=null,this.startData=null,this.currentData=null},$destructor:function(){r.$unregisterListeners(this),this._disconnectTouchEvents(),this.body=null},$prototype:{_connectTouchEvents:function(){if(!this.eventsAlreadyAttached){this.body=e.$window.document.body;for(var t=this._getInitialListenersList(),i=0;i<t.length;i++)this._addListener(t[i].evt,t[i].cb);this.eventsAlreadyAttached=!0}},_disconnectTouchEvents:function(){for(var e=this._getInitialListenersList(),t=0;t<e.length;t++)this._removeListener(e[t].evt,e[t].cb);this.eventsAlreadyAttached=!1},_getInitialListenersList:function(){return[]},_getAdditionalListenersList:function(){return[]},_getFakeEventsMap:function(){return{}},_gestureStart:function(e,t){return this.__validateNbTouches(e)?(this._disconnectTouchEvents(),this.startData={positions:s.getPositions(e),time:(new Date).getTime()},this.currentData=null,this._connectAdditionalTouchEvents(),this._getFakeEventsMap().start?this._raiseFakeEvent(e,this._getFakeEventsMap().start,t):null!=e.returnValue?e.returnValue:!e.defaultPrevented):null},_gestureMove:function(e,t){return this.__validateNbTouches(e)?(this.currentData={positions:s.getPositions(e),time:(new Date).getTime()},this._getFakeEventsMap().move?this._raiseFakeEvent(e,this._getFakeEventsMap().move,t):null!=e.returnValue?e.returnValue:!e.defaultPrevented):null},_gestureEnd:function(e,t){return this.__validateNbTouches(e)?(this._disconnectAdditionalTouchEvents(),this._connectTouchEvents(),this.currentData={positions:s.getPositions(e),time:(new Date).getTime()},this._getFakeEventsMap().end?this._raiseFakeEvent(e,this._getFakeEventsMap().end,t):null!=e.returnValue?e.returnValue:!e.defaultPrevented):null},_gestureCancel:function(e,t){return this._disconnectAdditionalTouchEvents(),this._connectTouchEvents(),this.currentData={positions:s.getPositions(e),time:(new Date).getTime()},this._getFakeEventsMap().cancel?this._raiseFakeEvent(e,this._getFakeEventsMap().cancel,t):null!=e.returnValue?e.returnValue:!e.defaultPrevented},_connectAdditionalTouchEvents:function(){for(var e=this._getAdditionalListenersList(),t=0;t<e.length;t++)this._addListener(e[t].evt,e[t].cb)},_disconnectAdditionalTouchEvents:function(){for(var e=this._getAdditionalListenersList(),t=0;t<e.length;t++)this._removeListener(e[t].evt,e[t].cb)},_addListener:function(e,i){t.addListener(this.body,e,i)},_removeListener:function(e,i){t.removeListener(this.body,e,i)},_raiseFakeEvent:function(e,t,r){var a=e.target?e.target:e.srcElement,n=aria.DomEvent.getFakeEvent(t,a);e.returnValue||n.preventDefault(),e.cancelBubble&&n.stopPropagation(),n.pageX=e.pageX,n.pageY=e.pageY,n.clientX=e.clientX,n.clientY=e.clientY,n.touches=e.touches,n.changedTouches=e.changedTouches,n.isPrimary=e.isPrimary,this.startData&&this.startData.time&&(n.duration=(new Date).getTime()-this.startData.time),r||(r={}),r.startX=this.startData.positions[0].x,r.startY=this.startData.positions[0].y;var o=s.getPositions(e);return r.currentX=o[0].x,r.currentY=o[0].y,n.detail=r,i.delegate(n),e.cancelBubble=n.hasStopPropagation,e.returnValue=!n.hasPreventDefault,e.returnValue},_calculateDistance:function(e,t,i,r){return Math.sqrt(Math.pow(i-e,2)+Math.pow(r-t,2))},__validateNbTouches:function(e){var t=s.getFingerIndex(e);return 1==this.NB_TOUCHES&&0===t||2==this.NB_TOUCHES&&t>=0}}});
//*******************
//LOGICAL-PATH:aria/touch/BaseTap.js
//*******************
var e=require("../Aria"),t=require("./Gesture");module.exports=e.classDefinition({$classpath:"aria.touch.BaseTap",$extends:t,$statics:{MARGIN:10},$prototype:{_getInitialListenersList:function(){return[{evt:this.touchEventMap.touchstart,cb:{fn:this._tapStart,scope:this}}]},_getAdditionalListenersList:function(){return[{evt:this.touchEventMap.touchmove,cb:{fn:this._tapMove,scope:this}},{evt:this.touchEventMap.touchend,cb:{fn:this._tapEnd,scope:this}}]},_tapStart:function(e){var t=this._gestureStart(e);return null==t?null!=e.returnValue?e.returnValue:!e.defaultPrevented:t},_tapMove:function(e){var t=aria.touch.Event.getPositions(e);if(this.MARGIN>=this._calculateDistance(this.startData.positions[0].x,this.startData.positions[0].y,t[0].x,t[0].y)){var i=this._gestureMove(e);return null==i?this._gestureCancel(e):i}return this._gestureCancel(e)},_tapEnd:function(e){var t=this._gestureEnd(e);return null==t?this._gestureCancel(e):null!=e.returnValue?e.returnValue:!e.defaultPrevented}}});
//*******************
//LOGICAL-PATH:aria/touch/ClickBuster.js
//*******************
var e=require("../Aria"),t=require("./Event"),i=require("../core/Browser");module.exports=e.classDefinition({$singleton:!0,$classpath:"aria.touch.ClickBuster",$statics:{RADIO:25,DELAY:500},$constructor:function(){this.isDesktop=i.DesktopView,this.lastEvt=null},$prototype:{registerTap:function(e){this.lastEvt={pos:{x:e.detail.currentX,y:e.detail.currentY},date:new Date}},preventGhostClick:function(e){return this._alreadyHandled(e)?(e.preventDefault(),e.stopPropagation(),!1):!0},_alreadyHandled:function(e){var i=t.getPositions(e)[0];return this.lastEvt&&this._isShortDelay(this.lastEvt.date,new Date)&&this._isSameArea(this.lastEvt.pos,i)},_isSameArea:function(e,t){return Math.abs(e.x-t.x)<this.RADIO&&Math.abs(e.y-t.y)<this.RADIO},_isShortDelay:function(e,t){return t-e<=this.DELAY}}});
//*******************
//LOGICAL-PATH:aria/touch/DoubleTap.js
//*******************
var e=require("../Aria"),t=require("./Gesture"),i=require("../core/Timer");module.exports=e.classDefinition({$singleton:!0,$classpath:"aria.touch.DoubleTap",$extends:t,$statics:{MARGIN:10,BETWEEN_DELAY:200},$prototype:{_getInitialListenersList:function(){return[{evt:this.touchEventMap.touchstart,cb:{fn:this._doubleTapStart,scope:this}}]},_getAdditionalListenersList:function(){return[{evt:this.touchEventMap.touchmove,cb:{fn:this._doubleTapMove,scope:this}},{evt:this.touchEventMap.touchend,cb:{fn:this._doubleTapEnd,scope:this}}]},_getFakeEventsMap:function(){return{doubletapstart:"doubletapstart",cancel:"doubletapcancel",finalize:"doubletap"}},_doubleTapStart:function(e){var t=this._gestureStart(e);return null==t?this.timerId?this._doubleTapCancel(e):null!=e.returnValue?e.returnValue:!e.defaultPrevented:this.timerId?(i.cancelCallback(this.timerId),t):this._raiseFakeEvent(e,this._getFakeEventsMap().doubletapstart)},_doubleTapMove:function(e){var t=aria.touch.Event.getPositions(e);if(this.MARGIN>=this._calculateDistance(this.startData.positions[0].x,this.startData.positions[0].y,t[0].x,t[0].y)){var i=this._gestureMove(e);return null==i?this._doubleTapCancel(e):i}return this._doubleTapCancel(e)},_doubleTapEnd:function(e){var t=this._gestureEnd(e);return null==t?this._doubleTapCancel(e):this.timerId?(this.timerId=null,this._raiseFakeEvent(e,this._getFakeEventsMap().finalize)):(this.timerId=i.addCallback({fn:this._doubleTapFinalCancel,scope:this,delay:this.BETWEEN_DELAY,args:e}),t)},_doubleTapCancel:function(e){return this.timerId&&(i.cancelCallback(this.timerId),this.timerId=null),this._gestureCancel(e)},_doubleTapFinalCancel:function(e){return this.timerId&&(i.cancelCallback(this.timerId),this.timerId=null),this._raiseFakeEvent(e,this._getFakeEventsMap().cancel)}}});
//*******************
//LOGICAL-PATH:aria/touch/Drag.js
//*******************
var e=require("../Aria"),t=require("./Gesture");module.exports=e.classDefinition({$singleton:!0,$classpath:"aria.touch.Drag",$extends:t,$prototype:{_getInitialListenersList:function(){return[{evt:this.touchEventMap.touchstart,cb:{fn:this._dragStart,scope:this}}]},_getAdditionalListenersList:function(){return[{evt:this.touchEventMap.touchmove,cb:{fn:this._dragMove,scope:this}},{evt:this.touchEventMap.touchend,cb:{fn:this._dragEnd,scope:this}}]},_getFakeEventsMap:function(){return{dragstart:"dragstart",dragmove:"dragmove",dragend:"drag",cancel:"dragcancel"}},_dragStart:function(e){var t=null!=this.currentData,i=this._gestureStart(e);return null==i&&t?(this.currentData={positions:aria.touch.Event.getPositions(e),time:(new Date).getTime()},this._raiseFakeEvent(e,this._getFakeEventsMap().cancel)):null==i?null!=e.returnValue?e.returnValue:!e.defaultPrevented:i},_dragMove:function(e){var t=null!=this.currentData,i=this._gestureMove(e);if(null!=i){var r=this._getFakeEventsMap().dragstart;return t&&(r=this._getFakeEventsMap().dragmove),this._raiseFakeEvent(e,r)}return this.currentData=null,t?this._gestureCancel(e):null!=e.returnValue?e.returnValue:!e.defaultPrevented},_dragEnd:function(e){var t=null!=this.currentData,i=this._gestureEnd(e);return t?null==i?null!=e.returnValue?e.returnValue:!e.defaultPrevented:this._raiseFakeEvent(e,this._getFakeEventsMap().dragend):null!=e.returnValue?e.returnValue:!e.defaultPrevented}}});
//*******************
//LOGICAL-PATH:aria/touch/LongPress.js
//*******************
var e=require("../Aria"),t=require("./Gesture"),i=require("../core/Timer");module.exports=e.classDefinition({$singleton:!0,$classpath:"aria.touch.LongPress",$extends:t,$statics:{MARGIN:10,PRESS_DURATION:1e3},$prototype:{_getInitialListenersList:function(){return[{evt:this.touchEventMap.touchstart,cb:{fn:this._longPressStart,scope:this}}]},_getAdditionalListenersList:function(){return[{evt:this.touchEventMap.touchmove,cb:{fn:this._longPressMove,scope:this}},{evt:this.touchEventMap.touchend,cb:{fn:this._longPressCancel,scope:this}}]},_getFakeEventsMap:function(){return{start:"longpressstart",cancel:"longpresscancel",finalize:"longpress"}},_longPressStart:function(e){var t=this._gestureStart(e);return null!=t?(this.timerId=i.addCallback({fn:this._longPressFinalize,scope:this,delay:this.PRESS_DURATION,args:e}),t):this.timerId?this._longPressCancel(e):null!=e.returnValue?e.returnValue:!e.defaultPrevented},_longPressMove:function(e){var t=aria.touch.Event.getPositions(e);if(this.MARGIN>=this._calculateDistance(this.startData.positions[0].x,this.startData.positions[0].y,t[0].x,t[0].y)){var i=this._gestureMove(e);return null==i?this._longPressCancel(e):i}return this._longPressCancel(e)},_longPressCancel:function(e){return this.timerId&&(i.cancelCallback(this.timerId),this.timerId=null),this._gestureCancel(e)},_longPressFinalize:function(e){this.timerId&&(i.cancelCallback(this.timerId),this.timerId=null),this._gestureEnd(e),this._raiseFakeEvent(e,this._getFakeEventsMap().finalize)}}});
//*******************
//LOGICAL-PATH:aria/touch/Pinch.js
//*******************
var e=require("../Aria"),t=require("./Gesture");module.exports=e.classDefinition({$singleton:!0,$classpath:"aria.touch.Pinch",$extends:t,$statics:{NB_TOUCHES:2},$events:{pinchstart:"",pinchmove:"",pinchend:"",pinchcancel:""},$constructor:function(){this.$Gesture.constructor.call(this),this.lastKnownAngle=null,this.initialPinchData=null,this.primaryPoint=null,this.secondaryPoint=null},$prototype:{_getInitialListenersList:function(){return[{evt:this.touchEventMap.touchstart,cb:{fn:this._pinchStart,scope:this}}]},_getAdditionalListenersList:function(){return[{evt:this.touchEventMap.touchmove,cb:{fn:this._pinchMove,scope:this}},{evt:this.touchEventMap.touchend,cb:{fn:this._pinchEnd,scope:this}}]},_getFakeEventsMap:function(){return{start:"pinchstart",move:"pinchmove",end:"pinch",cancel:"pinchcancel"}},_pinchStart:function(e){if(e.touches&&e.touches.length>=2){var t=aria.touch.Event.getPositions(e);this.primaryPoint=t[0],this.secondaryPoint=t[1]}else e.isPrimary?this.primaryPoint=aria.touch.Event.getPositions(e)[0]:"undefined"!=typeof e.isPrimary&&e.isPrimary===!1&&(this.secondaryPoint=aria.touch.Event.getPositions(e)[0]);if(e.touches&&e.touches.length>=2||"undefined"!=typeof e.isPrimary&&e.isPrimary===!1){var i=this._calculateDistance(this.primaryPoint.x,this.primaryPoint.y,this.secondaryPoint.x,this.secondaryPoint.y),r=this.__calculateAngle(this.primaryPoint.x,this.primaryPoint.y,this.secondaryPoint.x,this.secondaryPoint.y);return this.initialPinchData={distance:i,dVariation:0,angle:r},this.lastKnownAngle=r,this.$raiseEvent({name:"pinchstart",distance:i,dVariation:0,angle:r,originalEvent:e}),this._gestureStart(e,this.initialPinchData)}return null!=e.returnValue?e.returnValue:!e.defaultPrevented},_pinchMove:function(e){if(e.touches&&e.touches.length>=2){var t=aria.touch.Event.getPositions(e);this.primaryPoint=t[0],this.secondaryPoint=t[1]}else{if("undefined"==typeof e.isPrimary)return this.$raiseEvent({name:"pinchcancel"}),this._gestureCancel(e);e.isPrimary?this.primaryPoint=aria.touch.Event.getPositions(e):this.secondaryPoint=aria.touch.Event.getPositions(e)}var i=this._calculateDistance(this.primaryPoint.x,this.primaryPoint.y,this.secondaryPoint.x,this.secondaryPoint.y),r=this.__calculateAngle(this.primaryPoint.x,this.primaryPoint.y,this.secondaryPoint.x,this.secondaryPoint.y);this.lastKnownAngle=r;var s={distance:i,dVariation:i-this.initialPinchData.distance,angle:r};return this.$raiseEvent({name:"pinchmove",distance:i,dVariation:i-this.initialPinchData.distance,angle:r,originalEvent:e}),this._gestureMove(e,s)},_pinchEnd:function(e){if(e.touches&&e.changedTouches&&(e.changedTouches.length||0)+(e.touches.length||0)>=2){var t=aria.touch.Event.getPositions(e);this.primaryPoint=t[0],this.secondaryPoint=t[1]}if("undefined"!=typeof e.isPrimary&&(e.isPrimary?this.primaryPoint=aria.touch.Event.getPositions(e):this.secondaryPoint=aria.touch.Event.getPositions(e)),e.touches&&e.changedTouches&&(e.changedTouches.length||0)+(e.touches.length||0)>=2||"undefined"!=typeof e.isPrimary){var i=this._calculateDistance(this.primaryPoint.x,this.primaryPoint.y,this.secondaryPoint.x,this.secondaryPoint.y),r=this.__calculateAngle(this.primaryPoint.x,this.primaryPoint.y,this.secondaryPoint.x,this.secondaryPoint.y);Math.abs(r-this.lastKnownAngle)>150&&(r=this.__calculateAngle(this.secondaryPoint.x,this.secondaryPoint.y,this.primaryPoint.x,this.primaryPoint.y));var s={distance:i,dVariation:i-this.initialPinchData.distance,angle:r};return this.$raiseEvent({name:"pinchend",distance:i,dVariation:i-this.initialPinchData.distance,angle:r,originalEvent:e}),this._gestureEnd(e,s)}return this.$raiseEvent({name:"pinchcancel"}),this._gestureCancel(e)},__calculateAngle:function(e,t,i,r){return 180*Math.atan2(r-t,i-e)/Math.PI}}});
//*******************
//LOGICAL-PATH:aria/touch/SafeTap.js
//*******************
var e=require("../Aria");require("./ClickBuster");var t=require("./BaseTap");module.exports=e.classDefinition({$singleton:!0,$classpath:"aria.touch.SafeTap",$extends:t,$prototype:{_getFakeEventsMap:function(){return{start:"safetapstart",end:"safetap",cancel:"safetapcancel"}}}});
//*******************
//LOGICAL-PATH:aria/touch/SingleTap.js
//*******************
var e=require("../Aria"),t=require("./Gesture"),i=require("../core/Timer");module.exports=e.classDefinition({$singleton:!0,$classpath:"aria.touch.SingleTap",$extends:t,$statics:{MARGIN:10,FINAL_DELAY:250},$prototype:{_getInitialListenersList:function(){return[{evt:this.touchEventMap.touchstart,cb:{fn:this._singleTapStart,scope:this}}]},_getAdditionalListenersList:function(){return[{evt:this.touchEventMap.touchmove,cb:{fn:this._singleTapMove,scope:this}},{evt:this.touchEventMap.touchend,cb:{fn:this._singleTapEnd,scope:this}}]},_getFakeEventsMap:function(){return{start:"singletapstart",cancel:"singletapcancel",finalize:"singletap"}},_singleTapStart:function(e){if(this.timerId)return this._singleTapFinalCancel(e);var t=this._gestureStart(e);return null==t?null!=e.returnValue?e.returnValue:!e.defaultPrevented:t},_singleTapMove:function(e){var t=aria.touch.Event.getPositions(e);if(this.MARGIN>=this._calculateDistance(this.startData.positions[0].x,this.startData.positions[0].y,t[0].x,t[0].y)){var i=this._gestureMove(e);return null==i?this._singleTapCancel(e):i}return this._singleTapCancel(e)},_singleTapEnd:function(e){var t=this._gestureEnd(e);return null!=t?(this.timerId=i.addCallback({fn:this._singleTapFinalize,scope:this,delay:this.FINAL_DELAY,args:e}),t):this._singleTapCancel(e)},_singleTapCancel:function(e){return this.timerId&&(i.cancelCallback(this.timerId),this.timerId=null),this._gestureCancel(e)},_singleTapFinalize:function(e){this.timerId&&(i.cancelCallback(this.timerId),this.timerId=null),this._raiseFakeEvent(e,this._getFakeEventsMap().finalize)},_singleTapFinalCancel:function(e){return this.timerId&&(i.cancelCallback(this.timerId),this.timerId=null),this._raiseFakeEvent(e,this._getFakeEventsMap().cancel)}}});
//*******************
//LOGICAL-PATH:aria/touch/Swipe.js
//*******************
var e=require("../Aria"),t=require("./Gesture");module.exports=e.classDefinition({$singleton:!0,$classpath:"aria.touch.Swipe",$extends:t,$statics:{MARGIN:20},$events:{swipestart:"",swipemove:"",swipeend:"",swipecancel:""},$prototype:{_getInitialListenersList:function(){return[{evt:this.touchEventMap.touchstart,cb:{fn:this._swipeStart,scope:this}}]},_getAdditionalListenersList:function(){return[{evt:this.touchEventMap.touchmove,cb:{fn:this._swipeMove,scope:this}},{evt:this.touchEventMap.touchend,cb:{fn:this._swipeEnd,scope:this}}]},_getFakeEventsMap:function(){return{start:"swipestart",move:"swipemove",end:"swipe",cancel:"swipecancel"}},_swipeStart:function(e){var t=this._gestureStart(e);return null!=t?(this.$raiseEvent({name:"swipestart",startX:this.startData.positions[0].x,startY:this.startData.positions[0].y,originalEvent:e}),t):null!=e.returnValue?e.returnValue:!e.defaultPrevented},_swipeMove:function(e){var t=this._getRoute(this.startData.positions[0],aria.touch.Event.getPositions(e)[0]);if(t){var i=this._gestureMove(e,t);return null!=i?(this.$raiseEvent({name:"swipemove",route:t,originalEvent:e}),i):this._swipeCancel(e)}return this._swipeCancel(e)},_swipeEnd:function(e){var t=this._getRoute(this.startData.positions[0],aria.touch.Event.getPositions(e)[0]);if(t){var i=this._gestureEnd(e,t);return null!=i?(this.$raiseEvent({name:"swipeend",route:t,originalEvent:e}),i):this._swipeCancel(e)}return this._swipeCancel(e)},_swipeCancel:function(e){return this.$raiseEvent({name:"swipecancel"}),this._gestureCancel(e)},_getRoute:function(e,t){var i=t.x-e.x,r=t.y-e.y,s=Math.abs(i),a=Math.abs(r),n=a>s&&s<=this.MARGIN,o=s>a&&a<=this.MARGIN;return n?{direction:0>r?"up":"down",distance:a,startX:e.x,startY:e.y,endX:t.x,endY:t.y}:o?{direction:0>i?"left":"right",distance:s,startX:e.x,startY:e.y,endX:t.x,endY:t.y}:!1}}});
//*******************
//LOGICAL-PATH:aria/touch/Tap.js
//*******************
var e=require("../Aria"),t=require("./BaseTap");module.exports=e.classDefinition({$singleton:!0,$classpath:"aria.touch.Tap",$extends:t,$prototype:{_getFakeEventsMap:function(){return{start:"tapstart",end:"tap",cancel:"tapcancel"}}}});
//*******************
//LOGICAL-PATH:aria/touch/widgets/ButtonCfg.js
//*******************
var e=require("../../Aria"),t=require("../../core/JsonTypes"),i=require("../../html/beans/ElementCfg"),r=require("../../widgetLibs/CommonBeans");module.exports=e.beanDefinitions({$package:"aria.touch.widgets.ButtonCfg",$namespaces:{json:t,base:i,common:r},$beans:{Properties:{$type:"base:Properties",$properties:{on:{$type:"base:Properties.$properties.on",$properties:{type:{$type:"common:Callback"}}},isLink:{$type:"json:Boolean",$default:!1},delay:{$type:"json:Integer"},tagName:{$type:"base:Properties.$properties.tagName"}}}}});
//*******************
//LOGICAL-PATH:aria/touch/widgets/ButtonCSS.tpl.css
//*******************
Aria.classDefinition({$classpath:"aria.touch.widgets.ButtonCSS",$extends:"aria.templates.CSSTemplate",$constructor:function(){this.$CSSTemplate.constructor.call(this)},$destructor:function(){this.$CSSTemplate.$destructor.call(this)},$prototype:{macro_main:function(){try{with(this)this.__$write("\n\n.appLink, .appButton {\nposition: relative;\ndisplay: block;\nfont:normal 700 15px/17px tahoma,arial,helvetica,sans-serif;\npadding: 0.6em 1em;\nborder-radius: 16px;\ntext-align: center;\ncursor: pointer;\n}\n.appLink {\nbackground-color:#5393C5;\nborder:solid 1px #6FA0C0;\ncolor:#fff;\n}\n\n.appLink.touchLibButtonPressed {\noutline: 0 none;\nbackground-color:#5393C5;\nbackground: -webkit-linear-gradient(#5393C5, #6FACD5) repeat scroll 0 0 #5393C5;\nbackground: -ms-linear-gradient(#5393C5, #6FACD5) repeat scroll 0 0 #5393C5;\nbackground: -moz-linear-gradient(#5393C5, #6FACD5) repeat scroll 0 0 #5393C5;\nbackground: -o-linear-gradient(#5393C5, #6FACD5) repeat scroll 0 0 #5393C5;\nbackground: linear-gradient(#5393C5, #6FACD5) repeat scroll 0 0 #5393C5;\n\nfilter: progid:DXImageTransform.Microsoft.Gradient(startColorstr='#5393C5', endColorstr='#6FACD5', GradientType=0)\n}\n\n.appButton {\nbackground-color:#F1F1F1;\nborder:solid 1px #BABABA;\ncolor:#000;\n}\n\n.appButton.touchLibButtonPressed {\noutline: 0 none;\nbackground-color:#F1F1F1;\nbackground: -webkit-linear-gradient(#F1F1F1, #D6D6D6) repeat scroll 0 0 #F1F1F1;\nbackground: -ms-linear-gradient(#F1F1F1, #D6D6D6) repeat scroll 0 0 #F1F1F1;\nbackground: -moz-linear-gradient(#F1F1F1, #D6D6D6) repeat scroll 0 0 #F1F1F1;\nbackground: -o-linear-gradient(#F1F1F1, #D6D6D6) repeat scroll 0 0 #F1F1F1;\nbackground: linear-gradient(#F1F1F1, #D6D6D6) repeat scroll 0 0 #F1F1F1;\n\nfilter: progid:DXImageTransform.Microsoft.Gradient(startColorstr='#F1F1F1', endColorstr='#D6D6D6', GradientType=0)\n}\n\n.appLink[disabled], .appButton[disabled]  {\nborder: solid 1px #E8E8E8;\ncursor: default;\ncolor: #B9BEC0;\nbackground: #F1F1F1;\nbackground: -webkit-linear-gradient(#F1F1F1, #F7F7F7) repeat scroll 0 0 #BABABA;\nbackground: -ms-linear-gradient(#F1F1F1, #F7F7F7) repeat scroll 0 0 #BABABA;\nbackground: -moz-linear-gradient(#F1F1F1, #F7F7F7) repeat scroll 0 0 #BABABA;\nbackground: -o-linear-gradient(#F1F1F1, #F7F7F7) repeat scroll 0 0 #BABABA;\nbackground: linear-gradient(#F1F1F1, #F7F7F7) repeat scroll 0 0 #BABABA;\n\nfilter: progid:DXImageTransform.Microsoft.Gradient(startColorstr='#F1F1F1', endColorstr='#BABABA',GradientType=0)\n}\n\n",22)}catch(_ex){this.$logError(this.EXCEPTION_IN_MACRO,["main",this["aria:currentLineNumber"]],_ex)}},$init:function(e){e.__$csslibs={},e.__$prefix=!0},__$initTemplate:function(){return!0}}});
//*******************
//LOGICAL-PATH:aria/touch/widgets/Button.js
//*******************
var e=require("../../Aria");require("./ButtonCfg"),require("../Tap");var t=require("../../utils/ClassList"),i=require("./ButtonCSS.tpl.css"),r=require("../../html/Element"),s=require("../../core/Timer");module.exports=e.classDefinition({$classpath:"aria.touch.widgets.Button",$extends:r,$css:[i],$statics:{INVALID_USAGE:"Widget %1 can only be used as a %2.",BUTTON_CLASS:"appButton",LINK_CLASS:"appLink"},$constructor:function(e,t,i){this._timerId=null,e.tagName=e.tagName||"div",e.on=e.on||{},this._timeDelay=e.delay||30,this._isLink=e.isLink,this.$cfgBean=this.$cfgBean||"aria.touch.widgets.ButtonCfg.Properties",e.attributes&&e.attributes.disabled||this._registerListeners(e),this._classList=null,this.$Element.constructor.call(this,e,t,i)},$destructor:function(){this.timerId&&(s.cancelCallback(this.timerId),this.timerId=null),this._classList&&(this._classList.$dispose(),this._classList=null),this.$Element.$destructor.call(this)},$prototype:{writeMarkup:function(e){e.write("# Widget Error #"),this.$logError(this.INVALID_USAGE,["Button","container"])},initWidget:function(){this.$Element.initWidget.call(this),this._classList=new t(this._domElt);var e=this._isLink?this.LINK_CLASS:this.BUTTON_CLASS;this._classList.add(e)},_registerListeners:function(e){var t=e.on;this._chainListener(t,"tapstart",{fn:this._manageEvents,scope:this}),this._chainListener(t,"tapcancel",{fn:this._manageEvents,scope:this}),this._chainListener(t,"tap",{fn:this._manageEvents,scope:this})},_manageEvents:function(e){"tapstart"==e.type&&(this.timerId=s.addCallback({fn:this._delayedHighlightCB,scope:this,delay:this._timeDelay})),("tapcancel"==e.type||"tap"==e.type)&&(this.timerId&&(s.cancelCallback(this.timerId),this.timerId=null),("tapcancel"==e.type||"tap"==e.type&&!this._isLink)&&this._classList.remove("touchLibButtonPressed"))},_delayedHighlightCB:function(){this._classList.add("touchLibButtonPressed")}}});
//*******************
//LOGICAL-PATH:aria/touch/widgets/DoubleSliderCSS.tpl.css
//*******************
Aria.classDefinition({$classpath:"aria.touch.widgets.DoubleSliderCSS",$extends:"aria.templates.CSSTemplate",$constructor:function(){this.$CSSTemplate.constructor.call(this)},$destructor:function(){this.$CSSTemplate.$destructor.call(this)},$prototype:{macro_main:function(){try{with(this)this.__$write("\n\n.touchLibDoubleSlider {\nbackground: none repeat scroll 0 0 #EFF9FF;\nborder: 2px solid #999999;\nborder-radius: 1.5em;\nheight: 17px;\n}\n.touchLibDoubleSlider span {\nposition: absolute;\n}\n.touchLibDoubleSlider  > .touchContainer > .sliderButton {\nbackground: none repeat scroll 0 0 #ffffff;\nborder: 2px solid #4776A7;\nborder-radius: 32px 32px 32px 32px;\nwidth: 14px;\n}\n.touchLibDoubleSlider  > .touchContainer > .firstPoint {\nborder: 2px solid #4776A7;\nbackground-color:#4776A7;\nborder-radius: 1.5em 2px 2px 1.5em;\nwidth: 15px;\nheight: 24px;\nz-index: 3;\nmargin: 0;\n}\n.touchLibDoubleSlider > .touchContainer > .secondPoint {\nborder: 2px solid #4776A7;\nbackground-color: #4776A7;\nborder-radius: 2px 1.5em 1.5em 2px;\nwidth: 15px;\nheight: 24px;\nz-index: 3;\nmargin: 0;\n}\n.touchLibDoubleSlider > .touchContainer {\nz-index: 2;\nheight: 28px;\nmargin: -6px 0 0 0;\n}\n.touchLibDoubleSlider > .touchContainer > .sliderHighLight {\nz-index: 1;\nheight: 17px;\nwidth: 0px;\nbackground-color: #E3E3E3;\nmargin: 6px 0 0;\n}\n\n",22)}catch(_ex){this.$logError(this.EXCEPTION_IN_MACRO,["main",this["aria:currentLineNumber"]],_ex)}},$init:function(e){e.__$csslibs={},e.__$prefix=!0},__$initTemplate:function(){return!0}}});
//*******************
//LOGICAL-PATH:aria/touch/widgets/SliderCfgBeans.js
//*******************
var e=require("../../Aria"),t=require("../../core/JsonTypes"),i=require("../../widgetLibs/CommonBeans");module.exports=e.beanDefinitions({$package:"aria.touch.widgets.SliderCfgBeans",$namespaces:{json:t,common:i},$beans:{SliderCfg:{$type:"json:Object",$properties:{id:{$type:"json:String"},width:{$type:"json:Integer",$default:100},toggleSwitch:{$type:"json:Boolean",$default:!1},tapToMove:{$type:"json:Boolean",$default:!1},tapToToggle:{$type:"json:Boolean"},switchThreshold:{$type:"json:Float",$default:.5},onLabel:{$type:"json:String",$default:"ON"},offLabel:{$type:"json:String",$default:"OFF"},bind:{$type:"json:Object",$properties:{value:{$type:"json:Object",$properties:{inside:{$type:"json:ObjectRef",$mandatory:!0},to:{$type:"json:String",$mandatory:!0}}}}}}},DoubleSliderCfg:{$type:"json:Object",$properties:{id:{$type:"json:String"},width:{$type:"json:Integer",$default:100},bind:{$type:"json:Object",$properties:{value:{$type:"json:Object",$properties:{inside:{$type:"json:ObjectRef",$mandatory:!0},to:{$type:"json:String",$mandatory:!0}}}}},onchange:{$type:"common:Callback"}}}}});
//*******************
//LOGICAL-PATH:aria/touch/widgets/DoubleSlider.js
//*******************
var e=require("../../Aria"),t=require("./DoubleSliderCSS.tpl.css");require("./SliderCfgBeans");var i=require("../../utils/Dom"),r=require("../../utils/Type");require("../../utils/Mouse");var s=require("../../utils/Html"),a=require("../../widgetLibs/BaseWidget"),n=require("../../utils/Json"),o=require("../../core/Browser"),l=require("../../core/JsonValidator"),c=require("../../utils/dragdrop/Drag");module.exports=e.classDefinition({$classpath:"aria.touch.widgets.DoubleSlider",$extends:a,$css:[t],$statics:{INVALID_CONFIGURATION:"Invalid configuration for the slider!"},$constructor:function(e,t){if(this.$BaseWidget.constructor.apply(this,arguments),this._cfgOk=l.validateCfg("aria.touch.widgets.SliderCfgBeans.DoubleSliderCfg",e),this._cfgOk){this._firstWidth=0,this._secondWidth=0,this._railWidth=0,this.value=[0,0],this._oldValue=[0,0],this._readValue(),this._firstSlider=null,this._secondSlider=null,this._domElt=null,this._highlight=null,this._initialDrag=0;var i=this._cfg.bind?this._cfg.bind.value:null;this._binding=i,i&&(this._bindingCallback={fn:this._notifyDataChange,scope:this},n.addListener(i.inside,i.to,this._bindingCallback,!1)),this._savedX1=0,this._savedX2=0,this._domId=e.id?t.$getId(e.id):this._createDynamicId(),this._firstDomId=this._domId+"_first",this._secondDomId=this._domId+"_second",this._draggable=[]}},$destructor:function(){if(this._binding){var e=this._binding;n.removeListener(e.inside,e.to,this._bindingCallback,!1),this._bindingCallback=null}if(this._draggable)for(var t=0,i=this._draggable.length;i>t;t++)this._draggable[t].$dispose();this._draggable=null,this._firstSlider=null,this._secondSlider=null,this._domElt=null,this.$BaseWidget.$destructor.call(this)},$prototype:{getId:function(){return this._cfg.id},getDom:function(){return this._domElt.parentNode},writeMarkup:function(t){if(!this._cfgOk)return this.initWidget=e.empty,t.write(this.INVALID_CONFIGURATION);var i=this._cfg;i.attributes=i.attributes||{},i.attributes.classList=i.attributes.classList||[],i.attributes.classList.push("touchLibDoubleSlider"),t.write(["<div ",s.buildAttributeList(i.attributes),'" style="width:',this._cfg.width,'px;">','<span class="touchContainer" style="width:',i.width,'px;" id="',this._domId,'">','<span id="',this._secondDomId,'" class="sliderButton secondPoint" style="left:0px;"></span>','<span id="',this._firstDomId,'" class="sliderButton firstPoint" style="left:0px;"></span>','<span class="sliderHighLight" id="',this._domId+"_highlight",'"></span>',"</span></div>"].join(""))},initWidget:function(){this._readValue(),this._firstSlider=i.getElementById(this._firstDomId),this._secondSlider=i.getElementById(this._secondDomId),this._domElt=i.getElementById(this._domId),this._highlight=i.getElementById(this._domId+"_highlight"),this._firstWidth=parseInt(i.getStyle(this._firstSlider,"width"),10),this._firstWidth+=parseInt(i.getStyle(this._firstSlider,"borderLeftWidth"),10)||0,this._firstWidth+=parseInt(i.getStyle(this._firstSlider,"borderRightWidth"),10)||0,this._secondWidth=parseInt(i.getStyle(this._secondSlider,"width"),10),this._secondWidth+=parseInt(i.getStyle(this._secondSlider,"borderLeftWidth"),10)||0,this._secondWidth+=parseInt(i.getStyle(this._secondSlider,"borderRightWidth"),10)||0,this._railWidth=this._cfg.width-this._firstWidth-this._secondWidth,this._setLeft(),this._updateDisplay(),o.isOldIE&&(this.getDom().onselectstart=e.returnFalse),this._createSliderDrag()},_readValue:function(){var e,t=this._binding;t&&(e=t.inside[t.to],r.isArray(e)&&(this.value[0]=Math.max(0,Math.min(e[0],e[1],1)),this.value[1]=Math.min(1,Math.max(e[0],e[1],0))),n.setValue(t.inside,t.to,this.value,this._bindingCallback))},_setLeft:function(){var e=Math.max(0,Math.min(this.value[0],this.value[1],1)),t=Math.min(1,Math.max(this.value[0],this.value[1],0));this._savedX1=Math.floor(e*this._railWidth),this._savedX2=Math.ceil(t*this._railWidth+this._firstWidth)},_updateDisplay:function(){this._firstSlider.style.left=this._savedX1+"px",this._secondSlider.style.left=this._savedX2+"px",this._updateHighlight()},_updateHighlight:function(){var e=this._savedX1+this._firstWidth/2,t=this._savedX2+this._secondWidth/2-e;this._highlight.style.left=e+"px",this._highlight.style.width=t+"px"},_notifyDataChange:function(){this._readValue(),this._setLeft(),this._updateDisplay()},_createSliderDrag:function(){for(var e=[this._firstSlider,this._secondSlider],t=0,i=e.length;i>t;t++)this._draggable[t]=new c(e[t],{handle:e[t],proxy:null,axis:"x",constrainTo:this._domElt}),this._draggable[t].$on({dragstart:{fn:this._onDragStart,scope:this},move:{fn:this._onDragMove,scope:this},dragend:{fn:this._onDragEnd,scope:this}})},_onDragStart:function(e){this._oldValue=[this.value[0],this.value[1]],this._initialDrag=e.src.posX,this._initialSavedX=e.src.id===this._firstDomId?this._savedX1:this._savedX2},_onDragMove:function(e){this._move(e.src)},_onDragEnd:function(e){this._move(e.src),this._initialDrag=null,this._initialSavedX=null,(this._oldValue[0]!==this.value[0]||this._oldValue[1]!==this.value[1])&&this._cfg.onchange&&this._context.evalCallback(this._cfg.onchange)},_move:function(e){var t=this._initialSavedX+e.posX-this._initialDrag;if(e.id===this._firstDomId){var i=this._savedX2-this._firstWidth;this._savedX1=t>=i?i:t}else{var i=this._savedX1+this._firstWidth;this._savedX2=i>=t?i:t}this._updateHighlight(),this._setValue()},_setValue:function(){var e=this._savedX1,t=this._savedX2,i=Math.max(e/this._railWidth,0),r=Math.min((t-this._firstWidth)/this._railWidth,1);if(this.value[0]!==i||this.value[1]!==r){this.value=[i,r];var s=this._binding;n.setValue(s.inside,s.to,this.value)}else this._notifyDataChange()}}});
//*******************
//LOGICAL-PATH:aria/touch/widgets/PopupCSS.tpl.css
//*******************
Aria.classDefinition({$classpath:"aria.touch.widgets.PopupCSS",$extends:"aria.templates.CSSTemplate",$constructor:function(){this.$CSSTemplate.constructor.call(this)},$destructor:function(){this.$CSSTemplate.$destructor.call(this)},$prototype:{macro_main:function(){try{with(this)this.__$write("\n\ndiv.touchLibPopup {\nbackground: none repeat scroll 0 0 #EFF9FF;\nborder: 2px solid #999999;\nborder-radius: 32px 32px 32px 32px;\n}\n\n\n",22)}catch(_ex){this.$logError(this.EXCEPTION_IN_MACRO,["main",this["aria:currentLineNumber"]],_ex)}},$init:function(e){e.__$csslibs={},e.__$prefix=!0},__$initTemplate:function(){return!0}}});
//*******************
//LOGICAL-PATH:aria/touch/widgets/PopupCfgBeans.js
//*******************
var e=require("../../Aria"),t=require("../../core/JsonTypes"),i=require("../../widgetLibs/CommonBeans"),r=require("../../html/beans/ElementCfg"),s=require("../../utils/DomBeans"),a=require("../../templates/CfgBeans"),n=require("../../utils/css/AnimationsBean"),o=require("../../popups/Beans");module.exports=e.beanDefinitions({$package:"aria.touch.widgets.PopupCfgBeans",$namespaces:{json:t,common:i,base:r,dom:s,templates:a,animation:n,popup:o},$beans:{PopupCfg:{$type:"json:Object",$properties:{id:{$type:"json:String"},contentMacro:{$type:"templates:MacroCfg"},keepSection:{$type:"json:Boolean",$default:!1},modal:{$type:"json:Boolean",$default:!1},maskCssClass:{$type:"json:String"},domReference:{$type:"json:ObjectRef",$default:null},referenceId:{$type:"json:String",$default:null},absolutePosition:{$type:"popup:AbsolutePositionConfig",$default:null},center:{$type:"json:Boolean",$default:!1},maximized:{$type:"json:Boolean",$default:!1},closeOnMouseClick:{$type:"json:Boolean",$default:!0},closeOnMouseScroll:{$type:"json:Boolean",$default:!0},closeOnMouseOut:{$type:"json:Boolean",$default:!1},closeOnMouseOutDelay:{$type:"json:Integer",$default:500},preferredPositions:{$type:"json:Array",$contentType:{$type:"popup:PreferredPosition",$mandatory:!0},$default:[{}]},offset:{$type:"popup:OffsetConfig",$default:{}},ignoreClicksOn:{$type:"json:Array",$contentType:{$type:"json:ObjectRef"},$default:[{}]},parentDialog:{$type:"json:ObjectRef",$default:null},preferredWidth:{$type:"json:Integer",$default:-1},animateOut:{$type:"animation:AnimationName",$sample:"slide left"},animateIn:{$type:"animation:AnimationName",$sample:"slide left"},htmlContent:{$type:"json:String"},bind:{$type:"base:Properties.$properties.bind",$properties:{visible:{$type:"common:BindingRef"}}}}}}});
//*******************
//LOGICAL-PATH:aria/touch/widgets/Popup.js
//*******************
var e=require("../../Aria"),t=require("./PopupCSS.tpl.css");require("./PopupCfgBeans");var i=require("../../utils/Dom");require("../../utils/Mouse");var r=require("../../utils/Json"),s=require("../../widgetLibs/BindableWidget"),a=require("../../core/JsonValidator");module.exports=e.classDefinition({$classpath:"aria.touch.widgets.Popup",$extends:s,$css:[t],$statics:{BINDING_NEEDED:"The property '%2' from Widget %1 should be bound to a data model",CSS_CLASS:"touchLibPopup",WIDGET_CFG:"aria.touch.widgets.PopupCfgBeans.PopupCfg"},$constructor:function(e,t){this.$BindableWidget.constructor.apply(this,arguments),this._cfgOk=a.validateCfg(this.WIDGET_CFG,e),this._cfgOk&&(this._registerBindings(),this._domId=e.id?t.$getId(e.id):this._createDynamicId())},$prototype:{getId:function(){return this._cfg.id},writeMarkup:function(e){e.beginSection({id:"__popup_"+this._domId}),e.endSection()},_widgetMarkup:function(e){this._widgetMarkupBegin(e),this._widgetMarkupEnd(e)},_widgetMarkupBegin:function(e){e.beginSection({id:"__popup_"+this._domId})},_widgetMarkupEnd:function(e){e.endSection()},_writerCallback:function(e){e.write('<div class="'+this.CSS_CLASS+'">'),this._cfg.contentMacro&&e.callMacro(this._cfg.contentMacro),e.write("</div>")},initWidget:function(){this.$BindableWidget.initWidget.call(this);var e=this._cfg.bind,t=!1;if(e.visible){var i=this._transform(e.visible.transform,e.visible.inside[e.visible.to],"toWidget");i===!0&&this.show(),t=!0}t||this.$logWarn(this.BINDING_NEEDED,[this.$class,"visible"])},_notifyDataChange:function(e,t){"visible"===t&&(e.newValue?this.show():this._popup.close())},show:function(){var e=this._cfg,t={section:"__popup_"+this._domId,writerCallback:{fn:this._writerCallback,scope:this}},r=this._context.getRefreshedSection(t),s=new aria.popups.Popup;this._popup=s,s.$on({onAfterClose:this.disposePopup,scope:this}),null===e.domReference&&null===e.referenceId&&null===e.absolutePosition&&e.center===!1&&(e.absolutePosition={top:0,left:0});var a=null;e.domReference?a=e.domReference:e.referenceId&&(a=i.getElementById(this._context.$getId(e.referenceId))),s.open({section:r,keepSection:!0,modal:e.modal,maskCssClass:e.maskCssClass,domReference:a,absolutePosition:e.absolutePosition,center:e.center,maximized:e.maximized,closeOnMouseClick:e.closeOnMouseClick,closeOnMouseScroll:e.closeOnMouseScroll,closeOnMouseOut:e.closeOnMouseOut,closeOnMouseOutDelay:e.closeOnMouseOutDelay,preferredPositions:e.preferredPositions,offset:e.offset,ignoreClicksOn:e.ignoreClicksOn,parentDialog:e.parentDialog,preferredWidth:e.preferredWidth,animateOut:e.animateOut,animateIn:e.animateIn})},disposePopup:function(){this._popup&&(this._popup.$dispose(),this._popup=null),this._resetVisible()},_resetVisible:function(){var e=this._bindingListeners.visible;if(e){var t=this._transform(e.transform,!1,"fromWidget");r.setValue(e.inside,e.to,t,e.cb)}}}});
//*******************
//LOGICAL-PATH:aria/touch/widgets/SliderCSS.tpl.css
//*******************
Aria.classDefinition({$classpath:"aria.touch.widgets.SliderCSS",$extends:"aria.templates.CSSTemplate",$constructor:function(){this.$CSSTemplate.constructor.call(this)},$destructor:function(){this.$CSSTemplate.$destructor.call(this)},$prototype:{macro_main:function(){try{with(this)this.__$write("\n\n.touchLibSlider {\nbackground: none repeat scroll 0 0 #EFF9FF;\nborder: 2px solid #999999;\nborder-radius: 32px 32px 32px 32px;\nheight: 17px;\n}\n\n.touchLibSlider span {\nposition: absolute;\n}\n\n.touchLibSlider > .touchContainer > .touchLibSwitchOn, .touchLibSlider > .touchContainer > .touchLibSwitchOff{\nposition: absolute;\nborder-radius: 32px 32px 32px 32px;\nz-index: 1;\nheight: 17px;\nfont: normal 700 16px/17px arial,helvetica;\noverflow: hidden;\ntext-align: center;\ncursor: default;\n-moz-user-select: none;\n-webkit-user-select: none;\n-ms-user-select: none;\nuser-select: none;\n}\n.touchLibSlider > .touchContainer > .touchLibSwitchOn{\nbackground-color: #61A0CD;\ncolor: #fff;\n}\n\n.touchLibSlider > .touchContainer > .touchLibSwitchOff{\nbackground-color: #DADADA;\ncolor: #000;\n}\n\n\n.touchLibSlider > .touchContainer {\nposition: absolute;\nheight: 18px;\n}\n\n.touchLibSlider > .touchContainer > .sliderButton {\nbackground: none repeat scroll 0 0 #fff;\nborder: 2px solid #4776A7;\nborder-radius: 32px 32px 32px 32px;\nwidth: 14px;\nheight: 14px;\nz-index: 2;\n}\n\n.touchLibSlider  > .touchContainer > .sliderHighLight {\nz-index: 1;\nheight: 17px;\nwidth: 0px;\nbackground-color: #E3E3E3;\nborder-radius: 32px 0 0 32px;\n}\n\n",22)}catch(_ex){this.$logError(this.EXCEPTION_IN_MACRO,["main",this["aria:currentLineNumber"]],_ex)}},$init:function(e){e.__$csslibs={},e.__$prefix=!0},__$initTemplate:function(){return!0}}});
//*******************
//LOGICAL-PATH:aria/touch/widgets/Slider.js
//*******************
var e=require("../../Aria"),t=require("./SliderCSS.tpl.css");require("./SliderCfgBeans");var i=require("../../utils/Dom");require("../Tap");var r=require("../../utils/Html"),s=require("../../widgetLibs/BaseWidget"),a=require("../../utils/Json"),n=require("../../core/JsonValidator"),o=require("../../utils/dragdrop/Drag");module.exports=e.classDefinition({$classpath:"aria.touch.widgets.Slider",$extends:s,$css:[t],$statics:{INVALID_CONFIGURATION:"Invalid configuration for the slider!"},$constructor:function(e,t){if(this.$BaseWidget.constructor.apply(this,arguments),this._cfgOk=n.validateCfg("aria.touch.widgets.SliderCfgBeans.SliderCfg",e),this._cfgOk){this._value=0,this._readValue(),this._domId=e.id?t.$getId(e.id):this._createDynamicId(),this._highlightDomId=this._domId+"_highlight",this._parentDomId=this._domId+"_parent",this._onSwitchId=this._domId+"_on",this._offSwitchId=this._domId+"_off",this._isSwitch=e.toggleSwitch,this._switchThreshold=null!=e.switchThreshold?Math.min(1,Math.max(0,e.switchThreshold)):.5,this._onLabel=e.onLabel||"ON",this._offLabel=e.offLabel||"OFF",this._onContainer=null,this._offContainer=null,this._slider=null,this._highlight=null,this._sliderContainer=null,this._sliderWidth=null,this._sliderDimension=null,this._railWidth=null,this._savedX=null,this._initialDrag=null,this._delegateId=null;var i=this._cfg.bind?this._cfg.bind.value:null;this._binding=i,i&&(this._bindingCallback={fn:this._notifyDataChange,scope:this,args:!0},a.addListener(i.inside,i.to,this._bindingCallback,!1)),this._draggable=null}},$destructor:function(){if(this._delegateId&&(aria.utils.Delegate.remove(this._delegateId),this._delegateId=null),this._bindingCallback){var e=this._binding;a.removeListener(e.inside,e.to,this._bindingCallback,!1),this._bindingCallback=null}this._draggable&&(this._draggable.$dispose(),this._draggable=null),this._slider=null,this._highlight=null,this._sliderContainer=null,this._onContainer=null,this._offContainer=null,this._sliderDimension=null,this.$BaseWidget.$destructor.call(this)},$prototype:{getId:function(){return this._cfg.id},getDom:function(){return this._sliderContainer},writeMarkup:function(t){if(!this._cfgOk)return this.initWidget=e.empty,t.write(this.INVALID_CONFIGURATION);var i="",s=this._cfg;(s.tapToMove||s.tapToToggle&&this._isSwitch)&&(this._delegateId=aria.utils.Delegate.add({fn:this.delegate,scope:this}),i=aria.utils.Delegate.getMarkup(this._delegateId)),s.attributes=s.attributes||{},s.attributes.classList=s.attributes.classList||[],s.attributes.classList.push("touchLibSlider"),t.write(["<div ",r.buildAttributeList(s.attributes),'" style="width:',this._cfg.width,'px;" ',i,">",'<span class="touchContainer" style="width:',this._cfg.width,'px;" id="',this._parentDomId,'">','<span id="',this._domId,'" class="sliderButton" style="left:0px;"></span>'].join("")),t.write(this._isSwitch?['<div style="left:0px;width:',this._cfg.width,'px;" class="touchLibSwitchOn" id="',this._onSwitchId,'">',this._onLabel,"</div>",'<div style="left:0px;width:0px;" class="touchLibSwitchOff" id="',this._offSwitchId,'">',this._offLabel,"</div>"].join(""):['<span class="sliderHighLight" id="',this._highlightDomId,'"></span>'].join("")),t.write("</span></div>")},initWidget:function(){this._readValue();var e=i;this._slider=e.getElementById(this._domId),this._highlight=e.getElementById(this._highlightDomId),this._sliderContainer=e.getElementById(this._parentDomId),this._sliderDimension=i.getGeometry(this._sliderContainer),this._sliderWidth=parseInt(e.getStyle(this._slider,"width"),10),this._sliderWidth+=parseInt(i.getStyle(this._slider,"borderLeftWidth"),10)||0,this._sliderWidth+=parseInt(i.getStyle(this._slider,"borderRightWidth"),10)||0,this._railWidth=this._cfg.width-this._sliderWidth,this._isSwitch&&(this._onContainer=e.getElementById(this._onSwitchId),this._offContainer=e.getElementById(this._offSwitchId),this._updateSwitch()),this._setLeftPosition(),this._updateDisplay(),this._createSliderDrag()},_setLeftPosition:function(){var e=this._value;this._savedX=Math.floor(e*this._railWidth)},_updateSwitch:function(){var e=this._value;e>=this._switchThreshold?(this._onContainer.style.width=this._cfg.width+"px",this._onContainer.style.left="0px",this._offContainer.style.width="0px",this._value=1):(this._offContainer.style.width=this._cfg.width+"px",this._offContainer.style.left="0px",this._onContainer.style.width="0px",this._value=0),e!==this._value&&this._storeValue()},_createSliderDrag:function(){this._draggable=new o(this._slider,{handle:this._slider,proxy:null,axis:"x",constrainTo:this._sliderContainer}),this._draggable.$on({dragstart:{fn:this._onDragStart,scope:this},move:{fn:this._onDragMove,scope:this},dragend:{fn:this._onDragEnd,scope:this}})},_onDragStart:function(e){this._initialDrag=e.src.posX,this._initialSavedX=this._savedX},_onDragMove:function(e){this._move(e.src)},_onDragEnd:function(e){this._move(e.src),this._initialDrag=null,this._initialSavedX=null,this._isSwitch&&this._changeSwith()},_changeSwith:function(){this._updateSwitch(),this._setLeftPosition(),this._updateDisplay(),this._storeValue(this._value)},_storeValue:function(){var e=this._binding;e&&a.setValue(e.inside,e.to,this._value,this._bindingCallback)},_move:function(e){this._savedX=this._initialSavedX+e.posX-this._initialDrag,this._setValue(),this._isSwitch?this._switchDisplay():this._updateHighlight()},_switchDisplay:function(){var e=this._slider.offsetLeft;this._onContainer.style.width=this._sliderWidth+e+"px",this._offContainer.style.left=e+"px",this._offContainer.style.width=this._cfg.width-e+"px"},_setValue:function(){var e=this._savedX,t=Math.max(e/this._railWidth,0);t!==this._value?(this._value=t,this._storeValue()):this._notifyDataChange()},_readValue:function(e){var t,i=this._binding;i&&(t=i.inside[i.to],null==t&&(t=0),0>t&&(t=0),t>1&&(t=1),this._isSwitch&&e&&(t=t>=this._switchThreshold?1:0),this._value=t,this._storeValue())},_notifyDataChange:function(e,t){this._readValue(t),this._setLeftPosition(),this._updateDisplay()},_updateDisplay:function(){this._slider&&(this._slider.style.left=this._savedX+"px",this._isSwitch?this._switchDisplay():this._updateHighlight())},_updateHighlight:function(){this._highlight.style.width=this._savedX+this._sliderWidth/2+"px"},delegate:function(e){if("tap"===e.type){var t=this._cfg;if(!t)return!0;(t.tapToToggle||t.tapToMove)&&this._isSwitch?this._value=this._value>=this._switchThreshold?0:1:t.tapToMove&&(this._savedX=e.detail.currentX-this._sliderDimension.x-this._sliderWidth/2,this._savedX=this._savedX>this._railWidth?this._railWidth:this._savedX,this._value=Math.max(this._savedX/this._railWidth,0)),this._storeValue(),this._setLeftPosition(),this._updateDisplay()}}}});
//*******************
//LOGICAL-PATH:aria/touch/widgets/TouchWidgetLib.js
//*******************
var e=require("../../Aria"),t=require("../../widgetLibs/WidgetLib");module.exports=e.classDefinition({$classpath:"aria.touch.widgets.TouchWidgetLib",$extends:t,$singleton:!0,$prototype:{widgets:{Slider:"aria.touch.widgets.Slider",DoubleSlider:"aria.touch.widgets.DoubleSlider",Button:"aria.touch.widgets.Button",Popup:"aria.touch.widgets.Popup"}}});